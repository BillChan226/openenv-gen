"""
SQLAlchemy Models for {{ env_name }}

Auto-generated by EnvGenerator Multi-Agent System
"""

from datetime import datetime
from typing import Optional
from sqlalchemy import Column, Integer, String, Text, Boolean, DateTime, ForeignKey, Float, Numeric
from sqlalchemy.orm import relationship
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()


{% for entity in entities %}
class {{ entity.name }}(Base):
    """{{ entity.description or entity.name + ' model' }}"""
    
    __tablename__ = "{{ entity.table_name }}"
    
    {% for field in entity.fields %}
    {{ field.name }} = Column(
        {{ field.type }},
        {% if field.primary_key %}primary_key=True,{% endif %}
        {% if field.foreign_key %}ForeignKey("{{ field.foreign_key }}"),{% endif %}
        {% if field.unique %}unique=True,{% endif %}
        {% if field.nullable %}nullable=True,{% endif %}
        {% if field.default == 'now' %}default=datetime.utcnow,{% elif field.default is not none %}default={{ field.default }},{% endif %}
    )
    {% endfor %}
    
    {% for rel in entity.relationships %}
    {{ rel.name }} = relationship("{{ rel.target }}"{% if rel.back_populates %}, back_populates="{{ rel.back_populates }}"{% endif %})
    {% endfor %}
    
    def to_dict(self):
        return {
            {% for field in entity.fields %}
            "{{ field.name }}": self.{{ field.name }},
            {% endfor %}
        }


{% endfor %}

