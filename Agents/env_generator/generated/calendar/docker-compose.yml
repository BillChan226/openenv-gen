version: "3.9"

services:
  calendar_api:
    build:
      context: .
      dockerfile: Dockerfile.api
    container_name: calendar_api
    environment:
      DATABASE_URL: "sqlite:///./calendar.db"
    ports:
      - "8000:8000"
    volumes:
      - ./calendar_api:/app/calendar_api
      - calendar_api_data:/app
    networks:
      - calendar_net
    command: >
      uvicorn calendar_api.main:app
      --host 0.0.0.0
      --port 8000
      --reload

  calendar_ui:
    build:
      context: .
      dockerfile: Dockerfile.ui
    container_name: calendar_ui
    environment:
      VITE_API_BASE_URL: "http://calendar_api:8000"
    ports:
      - "5173:5173"
    volumes:
      - ./calendar_ui:/app/calendar_ui
      - /app/node_modules
    networks:
      - calendar_net
    command: >
      npm run dev
      -- --host 0.0.0.0
      --port 5173

networks:
  calendar_net:
    driver: bridge
volumes:
  calendar_api_data: {}
